shiny::runApp()
library(waiter)
runApp()
runApp()
runApp()
runApp()
runApp()
??autoWaiter
runApp()
runApp()
batas_kec_sulbar <- st_read("~/Documents/projects/cek-presensi/data/batas-administrasi-indonesia-master/2020/Batas Kecamatan SHP/Batas Kecamatan.shp")
library(sf)
library(leaflet)
library(dplyr)
library(openxlsx)
batas_kec_sulbar <- st_read("~/Documents/projects/cek-presensi/data/batas-administrasi-indonesia-master/2020/Batas Kecamatan SHP/Batas Kecamatan.shp")
batas_kec_sulbar <- readRDS("data/batas_kec_sulbar.rds")
presensi <- read.xlsx("data/agustus_presensi.xlsx")
presensi$lat1 <- as.numeric(presensi$lat1)
presensi$lat2 <- as.numeric(presensi$lat2)
presensi$lon1 <- as.numeric(presensi$lon1)
presensi$lon2 <- as.numeric(presensi$lon2)
View(presensi)
leaflet(batas_kec_sulbar) %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addMarkers(lng=119.3356, lat=-1.744539, popup="The birthplace of R") %>%
addPolygons()
batas_kec <- batas_kec_sulbar %>%
filter(Provinsi == "SULAWESI BARAT",
Kab_Kota == "PASANGKAYU",
Kecamatan == "DAPURANG")
View(batas_kec_sulbar)
batas_kec_sulbar <- batas_kec_sulbar %>%
mutate(category = if_else(Kab_Kota == "MAMUJU UTARA", "PASANGKAYU", Kab_Kota))
View(batas_kec_sulbar)
View(batas_kec_sulbar)
batas_kec_sulbar <- readRDS("data/batas_kec_sulbar.rds")
batas_kec_sulbar <- batas_kec_sulbar %>%
mutate(Kab_Kota = if_else(Kab_Kota == "MAMUJU UTARA", "PASANGKAYU", Kab_Kota))
View(batas_kec_sulbar)
presensi <- read.xlsx("data/agustus_presensi.xlsx")
presensi$lat1 <- as.numeric(presensi$lat1)
presensi$lat2 <- as.numeric(presensi$lat2)
presensi$lon1 <- as.numeric(presensi$lon1)
presensi$lon2 <- as.numeric(presensi$lon2)
presensi$presensi_cek[nrow(presensi)]
####
for (i in 1:nrow(presensi)) {
batas_kec = batas_kec_sulbar %>%
filter(Kab_Kota == presensi$Kabupaten[i],
Kecamatan == presensi$Kecamatan[i])
titik_awal <- st_sfc(st_point(c(presensi$lon1[i], presensi$lat1[i])),
crs = st_crs(batas_kec))
hasil_awal <- st_within(titik_awal, batas_kec)
titik_akhir <- st_sfc(st_point(c(presensi$lon2[i], presensi$lat2[i])),
crs = st_crs(batas_kec))
hasil_akhir <- st_within(titik_akhir, batas_kec)
# Mengecek hasilnya
if (lengths(hasil_awal) > 0 & lengths(hasil_akhir) > 0) {
print("Titik berada di dalam poligon kecamatan.")
presensi$presensi_cek[i] = "Titik berada di dalam poligon kecamatan"
} else if (lengths(hasil_awal) > 0 & lengths(hasil_akhir) <= 0) {
print("Titik akhir berada di luar poligon kecamatan.")
presensi$presensi_cek[i] = "Titik akhir berada di luar poligon kecamatan"
} else if (lengths(hasil_awal) <= 0 & lengths(hasil_akhir) > 0) {
print("Titik awal berada di luar poligon kecamatan.")
presensi$presensi_cek[i] = "Titik awal berada di luar poligon kecamatan"
} else {
print("Titik berada di luar poligon kecamatan.")
presensi$presensi_cek[i] = "Titik berada di luar poligon kecamatan"
}
}
write.xlsx(presensi, "cek_presensi_agustus.xlsx")
write.xlsx(presensi, "cek_presensi_agustus.xlsx")
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
